<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="VideoDo">
    <typeAlias alias="videoDo" type="com.jiankong.admin.domain.VideoDo"/>
	<resultMap id="video_result" class="videoDo">
		<result property="id" column="id" jdbcType="long" />
		<result property="create_author" column="create_author" jdbcType="String" />
		<result property="modify_author" column="modify_author" jdbcType="String" />
		<result property="title" column="title" jdbcType="String" />
		<result property="description" column="description" jdbcType="String" />
		<result property="feature" column="feature" jdbcType="String" />
		<result property="create_gmt" column="create_gmt" jdbcType="Date" />
		<result property="modify_gmt" column="modify_gmt" jdbcType="Date" />
		<result property="img_url" column="img_url" jdbcType="String" />
		<result property="url" column="url" jdbcType="String"/>
		<result property="viewtime" column="viewtime" jdbcType="int" />
		<result property="status" column="status" jdbcType="int" />
	</resultMap>
	
	<sql id="all_video_column">
	id,create_author,modify_author,title,description,feature,create_gmt,modify_gmt,img_url,url,viewtime,status
	</sql>
	
	<select id="Video.queryVideoById" resultClass = "java.lang.Long" resultMap = "video_result">
     select <include refid ="all_video_column" /> from video where id = #id#  and status = 1  
	</select>
	
	<insert id="Video.insertVideo" parameterClass = "videoDo">
	 insert into video values(null,#create_author#,default,#title#,#description#,#feature#,now(),null,#img_url#,#url#,default,default)
	<selectKey resultClass="java.lang.Long" keyProperty="id">
		select max(id) from video
	</selectKey> 
	</insert>
	
	<update id="Video.deleteVideo" parameterClass = "java.lang.Long">
    update video set status = 0 where id = #id#	
	</update>
	
	<update id="Video.updateVideo" parameterClass = "videoDo">
	update video set modify_author=#modify_author#,title=#title#,description=#description#,feature=#feature#,modify_gmt=now(),img_url=#img_url#,url=#url#,viewtime=#viewtime# where id=#id#
	</update>
	
   <select id="Video.queryVideoListByVideoIdList" resultMap="video_result">
   
   select <include refid = "all_video_column" /> from video
   where  status = 1 and
			id in 
			<iterate property="videoIdList"  open="(" close=")"  conjunction=",">
    					#videoIdList[]#   
	    	</iterate>
	</select>
	
	<select id="Video.queryVideoList" resultMap="video_result">
	select <include refid = "all_video_column" /> from video where status = 1 order by id desc
	</select>
	
	<select id="Video.getVideoCount" resultClass ="java.lang.Integer">
	select count(*) from video where status = 1
	</select>
	
	<select id="Video.queryVideoByVideoTitle" resultMap ="video_result">
	select <include refid="all_video_column"/> from video where title = #title# and status = 1
	</select>
	<update id="Video.addViewTimes" parameterClass="java.lang.Long">
		update video set viewtime =viewtime+1 where id = #id#
	</update>
</sqlMap>