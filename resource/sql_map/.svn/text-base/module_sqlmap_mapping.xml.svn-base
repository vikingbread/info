<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="ModuleDo">

    <typeAlias alias="moduleDo" type="com.jiankong.admin.domain.ModuleDo"/>
	<resultMap id="module_result" class="moduleDo">
		<result property="id" column="id" jdbcType="int" />
		<result property="name" column="name" jdbcType="string" />
		<result property="feature" column="feature" jdbcType="string" />
		<result property="property" column="property" jdbcType="string" />
	</resultMap>
	
	<sql id="all_module_column">
	id,name,feature,property
	</sql>
	
	<delete id="Module.deleteModule" parameterClass="java.lang.Integer">
	delete from modules where id = #id#
	
	</delete>
	
	<select id="Module.getModuleById" parameterClass="java.lang.Integer" resultMap="module_result">
	select <include refid="all_module_column" /> from modules where id= #id#  
	
	</select>
	
	<select id="Module.queryMouleByName" parameterClass="java.lang.String" resultMap="module_result">
	select <include refid="all_module_column" /> from modules where name=#name#
	
	</select>
	
	<insert id="Module.insertModule" parameterClass="moduleDo">
	insert into modules values(null,#name#,#feature#,#property#)
	<selectKey resultClass="java.lang.Integer" keyProperty="id">
		select max(id) from modules
	</selectKey> 
	</insert>
	
	<select id="Module.getAllModule" resultMap="module_result">
	select <include refid="all_module_column" /> from modules 
	</select>
	
	<update id="Module.updateModule" parameterClass="moduleDo" >
	update modules set name=#name#,feature =#feature#,property=#property# where id=#id#
	</update>
	
   <select id="Module.queryModuleByChannelId" parameterClass = "java.lang.Integer">
    select <include refid = "all_module_column" /> from modules where id = (select module_id from channel_module where channel_id = #channel_id#)
   </select>
   
   <select id="Module.queryModuleByIds" resultMap="module_result">
   
   select <include refid = "all_module_column" /> from modules
   where 
			id in 
			<iterate property="ids" open="(" close=")"  conjunction=",">
    					#ids[]#   
    					
	    	</iterate>
   </select>
   
   
   <select id="Module.queryModuleListByProperty" resultMap="module_result">
    select <include refid="all_module_column"/>  from modules where property = #property#
   </select>
   
   <select id="Module.getCountByProperty" resultClass="java.lang.Integer">
   select count(*) from modules where property =#property#
   </select>
   <select id="Module.getModuleCount" resultClass="java.lang.Integer">
   select count(*) from modules   
   </select>
</sqlMap>